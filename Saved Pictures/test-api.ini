// Скрипт для тестирования API с помощью curl команд
const { exec } = require('child_process');

const baseUrl = 'http://localhost:3000';

const commands = [
    // Получить всех пользователей
    `curl -X GET ${baseUrl}/users`,

    // Получить пользователя по ID
    `curl -X GET ${baseUrl}/users/1`,

    // Создать нового пользователя
    `curl -X POST -H "Content-Type: application/json" -d '{"name":"Charlie","email":"charlie@example.com"}' ${baseUrl}/users`,

    // Обновить пользователя (PUT)
    `curl -X PUT -H "Content-Type: application/json" -d '{"name":"Robert","email":"robert@example.com"}' ${baseUrl}/users/2`,

    // Частичное обновление (PATCH)
    `curl -X PATCH -H "Content-Type: application/json" -d '{"name":"Bobby"}' ${baseUrl}/users/2`,

    // Удалить пользователя
    `curl -X DELETE ${baseUrl}/users/3`,

    // Тест валидации (слишком длинное имя)
    `curl -X POST -H "Content-Type: application/json" -d '{"name":"This is a very long name that exceeds fifty characters limit","email":"test@example.com"}' ${baseUrl}/users`,

    // Тест валидации (неверный email)
    `curl -X POST -H "Content-Type: application/json" -d '{"name":"Test","email":"invalid-email"}' ${baseUrl}/users`
];

console.log('Testing User API...\n');

commands.forEach((command, index) => {
    setTimeout(() => {
        console.log(`Command ${index + 1}: ${command.split(' ')[2]}`);
        exec(command, (error, stdout, stderr) => {
            if (error) {
                console.error(`Error: ${error}`);
                return;
            }
            console.log('Response:', stdout);
            console.log('---');
        });
    }, index * 1000);
});